{"openapi":"3.1.0","info":{"title":"External SIEM Manager API","contact":{"name":"API Support","url":"http://exampleurl.com/contact","email":"carmelo.sciuto@cybersecurity.leonardocompany.com"},"license":{"name":"Apache 2.0","url":"https://www.apache.org/licenses/LICENSE-2.0.html"},"version":"0.0.1"},"servers":[{"url":"http://localhost:9490/","description":"localhost"},{"url":"https://cmp-kong-dev3.westeurope.cloudapp.azure.com/siem/","description":"develop"}],"tags":[{"name":"SIEM","description":"SIEM Manager Endpoint"}],"paths":{"/management":{"post":{"tags":["Siem"],"summary":"Add new SIEM","operationId":"upsertSiem","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Siem"}}},"required":true},"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/management/{siemUuid}/discovery":{"post":{"tags":["Siem"],"summary":"Discovery SIEM events and informations by siem uuid","operationId":"discoveryEventsAndInfos","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}},{"name":"siemUuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/encryption/key-vault":{"post":{"tags":["Encryption"],"summary":"Add new Key Vault","operationId":"upsertKeyVault","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyVault"}}},"required":true},"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/encryption/key-vault/v2":{"post":{"tags":["Encryption"],"summary":"Add new Key Vault","operationId":"upsertKeyVaultV2","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyVault"}}},"required":true},"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/management/{uuid}":{"get":{"tags":["Siem"],"summary":"Get SIEM by UUID","operationId":"getSiemByUuid","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}},{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/Siem"}}}}}},"delete":{"tags":["Siem"],"summary":"Delete SIEM by UUID","operationId":"deleteSiem","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}},{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/management/list":{"get":{"tags":["Siem"],"summary":"Lists SIEM","operationId":"listSiem","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Siem"}}}}}}}},"/management/discovery":{"get":{"tags":["Siem"],"summary":"Batch Discovery SIEMs events and informations","operationId":"batchDiscoveryEventsAndInfos","parameters":[{"name":"X-Batch","in":"header","required":false,"schema":{"type":"boolean","default":false}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/management/discovery/{siemType}":{"get":{"tags":["Siem"],"summary":"Batch Discovery SIEMs events and informations","operationId":"batchDiscoveryEventsAndInfos_1","parameters":[{"name":"siemType","in":"path","required":true,"schema":{"type":"string","enum":["SENTINEL","CHRONICLE"]}},{"name":"X-Batch","in":"header","required":false,"schema":{"type":"boolean","default":false}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/encryption/key-vault/{uuid}":{"get":{"tags":["Encryption"],"summary":"Get  Key Vault by UUID","operationId":"getKeyVaultByUuid","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}},{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/KeyVault"}}}}}},"delete":{"tags":["Encryption"],"summary":"Delete Key Vault by UUID","operationId":"deleteKeyVault","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}},{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/encryption/key-vault/{uuid}/discovery":{"get":{"tags":["Encryption"],"summary":"Discovery KeyVault secrets and informations by key vault uuid","operationId":"discoverySecretsAndInfos","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}},{"name":"uuid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/encryption/key-vault/list":{"get":{"tags":["Encryption"],"summary":"Key Vault List","operationId":"listKeyVault","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KeyVault"}}}}}}}},"/encryption/key-vault/discovery":{"get":{"tags":["Encryption"],"summary":"Batch Discovery KeyVaults secrets and informations","operationId":"batchDiscoveryKeyVaults","parameters":[{"name":"X-Batch","in":"header","required":false,"schema":{"type":"boolean","default":false}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"abstraction-layer"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK"}}}},"/encryption/disk-set":{"get":{"tags":["Encryption"],"summary":"Get List disk encryption set by UUID","operationId":"getdiskEncryptionByUuid","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}},{"name":"uuid","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DiskEncryptionSets"}}}}}}}},"/analytics/kqls":{"get":{"tags":["Analytics"],"summary":"KQL queries about a SIEM","operationId":"siemQueries","parameters":[{"name":"uuid","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"granularity","in":"query","required":false,"schema":{"type":"string","default":"1d"}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/QueryKQL"}}}}}}}},"/analytics/key-vault/secrets":{"get":{"tags":["Analytics"],"summary":"Secrets about a Key Vault","operationId":"keyVaultSecrets","parameters":[{"name":"uuid","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KeyVaultInfo"}}}}}}}},"/analytics/key-vault/keys":{"get":{"tags":["Analytics"],"summary":"Keys about a Key Vault","operationId":"keyVaultKeys","parameters":[{"name":"uuid","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KeyVaultInfo"}}}}}}}},"/analytics/key-vault/diskencryptionsets":{"get":{"tags":["Analytics"],"summary":"Disk Encryption Sets about a Key Vault","operationId":"keyVaultDiskEncryptionSets","parameters":[{"name":"uuid","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DiskEncryptionSets"}}}}}}}},"/analytics/key-vault/certificates":{"get":{"tags":["Analytics"],"summary":"Certificates about a Key Vault","operationId":"keyVaultCertificates","parameters":[{"name":"uuid","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KeyVaultInfo"}}}}}}}},"/analytics/incidents":{"get":{"tags":["Analytics"],"summary":"Incidents about a SIEM","operationId":"siemIncidents","parameters":[{"name":"uuid","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Incident"}}}}}}}},"/analytics/graphIncident":{"get":{"tags":["Analytics"],"summary":"Get Incidents Graph","operationId":"aggregateIncidentsByTenant","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object","additionalProperties":{}}}}}}}}},"/analytics/graphAlert":{"get":{"tags":["Analytics"],"summary":"Get Alerts Graph","operationId":"aggregateAlertByTenant","parameters":[{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object","additionalProperties":{}}}}}}}}},"/analytics/alertRules":{"get":{"tags":["Analytics"],"summary":"Alert rules about a SIEM","operationId":"siemAlertRules","parameters":[{"name":"uuid","in":"query","required":false,"schema":{"type":"array","items":{"type":"string"}}},{"name":"X-Tenant","in":"header","required":false,"schema":{"type":"string","default":"resources"}}],"responses":{"400":{"description":"Bad Request","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GenericException"}}}},"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AlertRule"}}}}}}}}},"components":{"schemas":{"GenericException":{"type":"object","properties":{"cause":{"type":"object","properties":{"stackTrace":{"type":"array","items":{"type":"object","properties":{"classLoaderName":{"type":"string"},"moduleName":{"type":"string"},"moduleVersion":{"type":"string"},"methodName":{"type":"string"},"fileName":{"type":"string"},"lineNumber":{"type":"integer","format":"int32"},"className":{"type":"string"},"nativeMethod":{"type":"boolean"}}}},"message":{"type":"string"},"localizedMessage":{"type":"string"}}},"stackTrace":{"type":"array","items":{"type":"object","properties":{"classLoaderName":{"type":"string"},"moduleName":{"type":"string"},"moduleVersion":{"type":"string"},"methodName":{"type":"string"},"fileName":{"type":"string"},"lineNumber":{"type":"integer","format":"int32"},"className":{"type":"string"},"nativeMethod":{"type":"boolean"}}}},"errorCode":{"type":"string"},"errorMessage":{"type":"string"},"message":{"type":"string"},"suppressed":{"type":"array","items":{"type":"object","properties":{"stackTrace":{"type":"array","items":{"type":"object","properties":{"classLoaderName":{"type":"string"},"moduleName":{"type":"string"},"moduleVersion":{"type":"string"},"methodName":{"type":"string"},"fileName":{"type":"string"},"lineNumber":{"type":"integer","format":"int32"},"className":{"type":"string"},"nativeMethod":{"type":"boolean"}}}},"message":{"type":"string"},"localizedMessage":{"type":"string"}}}},"localizedMessage":{"type":"string"}}},"ServiceAccountGoogle":{"type":"object","properties":{"type":{"type":"string"},"project_id":{"type":"string"},"private_key_id":{"type":"string"},"private_key":{"type":"string"},"client_email":{"type":"string","pattern":"^[a-zA-Z0-9_!#$%&ï¿½*+/=?`{|}~^.-]+@[a-zA-Z0-9.-]+$"},"client_id":{"type":"string"},"auth_uri":{"type":"string"},"token_uri":{"type":"string"},"auth_provider_x509_cert_url":{"type":"string"},"client_x509_cert_url":{"type":"string"}}},"Siem":{"type":"object","properties":{"uuid":{"type":"string","pattern":"\\b[0-9a-f]{8}\\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\\b[0-9a-f]{12}\\b"},"name":{"type":"string"},"type":{"type":"string","enum":["SENTINEL","CHRONICLE"]},"creationDate":{"type":"string","format":"date-time"},"properties":{"$ref":"#/components/schemas/SiemProperties"}}},"SiemProperties":{"type":"object","properties":{"clientId":{"type":"string"},"clientSecret":{"type":"string"},"tenantId":{"type":"string"},"subscriptionId":{"type":"string"},"workspaceId":{"type":"string"},"workspaceName":{"type":"string"},"serviceAccount":{"$ref":"#/components/schemas/ServiceAccountGoogle"},"resourceGroup":{"type":"string"}}},"KeyVault":{"type":"object","properties":{"uuid":{"type":"string","pattern":"\\b[0-9a-f]{8}\\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\\b[0-9a-f]{12}\\b"},"name":{"type":"string"},"creationDate":{"type":"string","format":"date-time"},"properties":{"$ref":"#/components/schemas/KeyVaultProperties"},"type":{"type":"string","enum":["Azure","VMWare","CMP","Google","AzureStack","AzureStackHCI","OpenShift","AmazonWebServices","AzureStackHybridCloud","Oracle","VCloudDirector","Kubernetes","OracleExAcc","RedHatEdge"]}}},"KeyVaultProperties":{"type":"object","properties":{"clientId":{"type":"string"},"clientSecret":{"type":"string"},"tenantId":{"type":"string"},"subscriptionId":{"type":"string"},"resourceGroup":{"type":"string"},"privateUrl":{"type":"string","pattern":"^(http[s])://[-a-zA-Z0-9+&@#/%?=~_|!:,.;]*[-a-zA-Z0-9+&@#/%=~_|]"},"serviceAccount":{"$ref":"#/components/schemas/ServiceAccountGoogle"},"kmsProjectId":{"type":"string"}}},"DiskEncryptionSets":{"type":"object","properties":{"name":{"type":"string"},"id":{"type":"string"},"uuid":{"type":"string"},"location":{"type":"string"},"identityType":{"type":"string"},"principalId":{"type":"string"},"tenantId":{"type":"string"},"activeKeyId":{"type":"string"},"encryptionType":{"type":"string"},"rotationToLatestKeyVersionEnabled":{"type":"boolean"},"provisioningState":{"type":"string"},"systemUuid":{"type":"string"},"keyUri":{"type":"string"}}},"QueryKQL":{"type":"object","properties":{"name":{"type":"string"},"siemUuid":{"type":"string"},"workspaceName":{"type":"string"},"titleEN":{"type":"string"},"titleIT":{"type":"string"},"descriptionEN":{"type":"string"},"descriptionIT":{"type":"string"},"query":{"type":"string"},"response":{"$ref":"#/components/schemas/TableKQL"},"granularity":{"type":"string"}}},"TableKQL":{"type":"object","properties":{"columns":{"type":"array","items":{"type":"string"}},"rows":{"type":"array","items":{"type":"array","items":{"type":"string"}}}}},"KMSDetailsData":{"type":"object","properties":{"name":{"type":"string"},"createTime":{"type":"string"},"keys":{"type":"array","items":{"$ref":"#/components/schemas/KMSKey"}}}},"KMSKey":{"type":"object","properties":{"name":{"type":"string"},"purpose":{"type":"string"},"createTime":{"type":"string"},"destroyScheduledDuration":{"type":"string"},"nextRotationTime":{"type":"string"},"primary":{"$ref":"#/components/schemas/KMSPrimaryDetails"},"versionTemplate":{"$ref":"#/components/schemas/KMSKeyVersionTemplate"}}},"KMSKeyVersionTemplate":{"type":"object","properties":{"protectionLevel":{"type":"string"},"algorithm":{"type":"string"}}},"KMSLocationData":{"type":"object","properties":{"location":{"type":"string"},"systemUuid":{"type":"string"},"details":{"type":"array","items":{"$ref":"#/components/schemas/KMSDetailsData"}}}},"KMSPrimaryDetails":{"type":"object","properties":{"name":{"type":"string"},"state":{"type":"string"},"createTime":{"type":"string"},"protectionLevel":{"type":"string"},"algorithm":{"type":"string"},"importJob":{"type":"string"},"importTime":{"type":"string"},"reimportEligible":{"type":"boolean"}}},"KeyVaultInfo":{"type":"object","properties":{"uuid":{"type":"string"},"type":{"type":"string","enum":["KEY","SECRET","CERTIFICATE"]},"vaultUuid":{"type":"string"},"subscriptionId":{"type":"string"},"resourceGroup":{"type":"string"},"name":{"type":"string"},"enabled":{"type":"boolean"},"retentionDays":{"type":"integer","format":"int32"},"azureVaultId":{"type":"string"},"creationDate":{"type":"string","format":"date-time"},"updateDate":{"type":"string","format":"date-time"},"kms":{"$ref":"#/components/schemas/KMSLocationData"}}},"Incident":{"type":"object","properties":{"uuid":{"type":"string"},"siemUuid":{"type":"string"},"name":{"type":"string"},"number":{"type":"integer","format":"int32"},"status":{"type":"string"},"alertCount":{"type":"integer","format":"int32"},"url":{"type":"string"},"description":{"type":"string"},"severity":{"type":"string"},"classification":{"type":"string"},"alertRuleUuids":{"type":"array","items":{"type":"string"}}}},"AlertRule":{"type":"object","properties":{"uuid":{"type":"string"},"siemUuid":{"type":"string"},"name":{"type":"string"},"description":{"type":"string"},"severity":{"type":"string"},"enabled":{"type":"boolean"},"kind":{"type":"string"},"tactics":{"type":"array","items":{"type":"string"}}}}}}}